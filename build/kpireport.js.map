{"version":3,"file":"kpireport.js","sources":["webpack:///src/shared/kpireport.js","webpack:///src/actions/kpireport/kpireport.js"],"sourcesContent":["import React from 'react';\n\n\n\nimport logo from './logo.svg';\nimport \"./App.css\";\n\n\n// require('es6-promise');\n// require('isomorphic-fetch');\n\n// import 'whatwg-fetch';\n\n\nimport 'isomorphic-fetch';\nimport {\n\tmatch,\n\tRoutingContext,\n\tRouter,\n\tRoute,\n\tIndexRoute,\n\tIndexRedirect,\n\tRedirect,\n\tLink,\n\tbrowserHistory\n} from 'react-router';\n\n\nimport cookie from 'react-cookies';\n\nimport {\n\tconnect\n} from 'react-redux';\n\nimport {\n\tbindActionCreators\n} from 'redux';\n\nimport * as actionCreators from '../actions/kpireport/kpireport';\n\nfunction toQueryString(obj) {\n\treturn obj ? Object.keys(obj).sort().map(function(key) {\n\t\tvar val = obj[key];\n\t\tif (Array.isArray(val)) {\n\t\t\treturn val.sort().map(function(val2) {\n\t\t\t\treturn encodeURIComponent(key) + '=' + encodeURIComponent(val2);\n\t\t\t}).join('&');\n\t\t}\n\t\treturn encodeURIComponent(key) + '=' + encodeURIComponent(val);\n\t}).join('&') : '';\n}\n\n\nclass KpiReport extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\t// this.state = {\n\t\t// \tkpiReportData: []\n\t\t// }\n\t}\n\n\tcomponentWillMount() {\n\t\t// this.getUserProfile();\n\t}\n\n\tcomponentDidMount() {\n\n\t\tconsole.log(this.props, '看一看props');\n\n\t\tvar token = cookie.load('token');\n\n\t\tif (global.token) {\n\t\t\ttoken = global.token;\n\t\t} else {\n\t\t\ttoken = cookie.load('token');\n\t\t}\n\n\t\tif (token == undefined) {\n\t\t\tthis.props.router.push('/login');\n\t\t} else {\n\t\t\tif (!this.props.login) {\n\t\t\t\tthis.props.router.push('/login');\n\t\t\t} else {\n\t\t\t\tthis.props.KpiListFn(token, this.props);\n\t\t\t}\n\n\t\t}\n\t}\n\n\tgetTmp() {\n\t\tvar list = [];\n\n\t\tthis.props.kpiListData.map((v, k) => {\n\t\t\tlist.push(<tr key={k}>\n\t\t\t\t<td>{v.appCode}</td>\n\n\t\t\t\t<td>{v.channelType}</td>\n\n\n\t\t\t\t<td>{v.online}</td>\n\t\t\t\t</tr>);\n\t\t});\n\n\t\treturn list;\n\t}\n\n\n\trender() {\n\n\t\tconsole.log(this.props, 'props kpi');\n\t\tvar dataTmp = this.getTmp();\n\n\n\t\treturn (\n\t\t\t<div className=\"App\">\n\t\t\t\t<div className=\"App-header\">\n\t\t\t\t\t<img src={logo} className=\"App-logo\" alt=\"logo\" />\n\t\t\t\t\t<h2>react同构直出demo</h2>\n\t\t\t\t</div>\n\t\t\t\t<p className=\"App-intro\">是不是很酷？ KPI报表</p>\n\t\t\t\t<div className=\"left\">\n\t\t\t\t\t<Link to=\"/\">用户概况</Link>\n\t\t\t\t\t<Link to=\"/kpireport\">KPI报表</Link>\n\t\t\t\t\t<Link to =\"/login\">登录</Link>\n\t\t\t\t\t\n\t\t\t\t\t<Link to =\"/getdata\">开放型数据</Link>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"right\">\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<thead>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>操作系统</td>\n\t\t\t\t\t\t\t<td>渠道类型</td>\n\t\t\t\t\t\t\t<td>线上线下</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t{dataTmp}\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\n//将state.counter绑定到props的counter\nconst mapStateToProps = (state) => {\n\n\tconsole.log(state, 'kpi date###');\n\treturn {\n\t\tkpiListData: state.KpiList.KpiList,\n\t\tlogin: state.Login.login\n\t}\n};\n\n\n//将action的所有方法绑定到props上\nconst mapDispatchToProps = (dispatch, ownProps) => {\n\n\t//全量\n\treturn bindActionCreators(actionCreators, dispatch);\n\n\t// return {\n\t// \tinit: bindActionCreators({\n\t// \t\taddTodo\n\t// \t}, dispatch),\n\t// \tinit2: bindActionCreators({\n\t// \t\tinit2\n\t// \t}, dispatch)\n\t// }\n\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(KpiReport);\n\n\n// WEBPACK FOOTER //\n// src/shared/kpireport.js","\t\tfunction toQueryString(obj) {\n\t\t\treturn obj ? Object.keys(obj).sort().map(function(key) {\n\t\t\t\tvar val = obj[key];\n\t\t\t\tif (Array.isArray(val)) {\n\t\t\t\t\treturn val.sort().map(function(val2) {\n\t\t\t\t\t\treturn encodeURIComponent(key) + '=' + encodeURIComponent(val2);\n\t\t\t\t\t}).join('&');\n\t\t\t\t}\n\t\t\t\treturn encodeURIComponent(key) + '=' + encodeURIComponent(val);\n\t\t\t}).join('&') : '';\n\t\t}\n\n\t\texport const KpiListFn = (token, props) => {\n\n\t\t\tconsole.log(props, 'props');\n\n\t\t\treturn function(dispatch) {\n\t\t\t\treturn fetch(\"http://127.0.0.1:3001/user_kpireport_list\", {\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tmode: 'cors',\n\t\t\t\t\t\tcache: 'default',\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded',\n\t\t\t\t\t\t\t'Authorization': 'Bearer ' + token\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbody: toQueryString({\n\t\t\t\t\t\t\tappCode: 27,\n\t\t\t\t\t\t\tsecondParam: 'yourOtherValue'\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t\t.then(res => res.json())\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tif (res.status) {\n\t\t\t\t\t\t\t// console.log(res.data);\n\n\t\t\t\t\t\t\t// this.setState({\n\t\t\t\t\t\t\t// \tkpiReportData: res.data\n\t\t\t\t\t\t\t// });\n\n\t\t\t\t\t\t\tconsole.log(res.data, 'fetch');\n\t\t\t\t\t\t\tdispatch({\n\t\t\t\t\t\t\t\ttype: \"kpiList\",\n\t\t\t\t\t\t\t\tpayload: res.data\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (res.msg == -1) {\n\n\t\t\t\t\t\t\t\t// console.log(this.props.router.push('/login'));\n\n\t\t\t\t\t\t\t\t// this.props.router.push('/login');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t})\n\n\t\t\t}\n\t\t};\n\n\n// WEBPACK FOOTER //\n// src/actions/kpireport/kpireport.js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAGA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAYA;AACA;AACA;AACA;AAGA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;AAEA;AAAA;AACA;AADA;AACA;AAEA;AACA;AACA;AACA;AACA;;;AACA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AANA;AAQA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AALA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHA;AAFA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAVA;AADA;AAdA;AAgCA;;;;AA/FA;AACA;AAiGA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;;;;;;;;ACnLA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AARA;AAaA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;;;;A","sourceRoot":""}